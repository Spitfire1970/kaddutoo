import{j as e,r as n,M as j,a as w}from"./index-BQ78cWnp.js";const N=({path:l,onClick:d,onEnter:a,onLeave:c})=>e.jsx("div",{className:"cursor-pointer aspect-square",onClick:d,onMouseEnter:a,onMouseLeave:c,children:e.jsx("img",{src:l,className:"w-full h-full object-cover",alt:""})}),b=({images:l,setImages:d})=>{const[a,c]=n.useState(null),[u,o]=n.useState(null),[i,m]=n.useState(null);n.useEffect(()=>{if(!a){o(null);return}const t=URL.createObjectURL(a);return o(t),()=>URL.revokeObjectURL(t)},[a]);const f=t=>{if(!t.target.files||t.target.files.length===0){c(null);return}const s=t.target.files[0];c(s),h(s)},h=t=>{const s=new FileReader;s.onload=r=>{const x=new Image;x.onload=()=>{const v={name:t.name,type:t.type,size:Math.round(t.size/1024)+" KB",shot:new Date(t.lastModified).toLocaleString(),dimensions:`${x.width}x${x.height}`};m(v)},x.src=r.target.result},s.readAsDataURL(t)},p=()=>{m(null),o(null),c(null)},g=async()=>{if(!a)return;const t=new FormData;t.append("image",a),t.append("info",JSON.stringify(i));try{const s=await w.post("/api/upload",t,{headers:{"Content-Type":"multipart/form-data"}});d(l.concat(s.data)),m(null),o(null),c(null)}catch(s){console.error("Error uploading image:",s)}};return e.jsxs("div",{className:"flex flex-col items-center w-full max-w-2xl mx-auto px-4 mt-5",children:[e.jsx("input",{id:"browse_button",type:"file",accept:"image/*",onChange:f,className:"sr-only"}),e.jsx("label",{htmlFor:"browse_button",className:"cursor-pointer font-medium text-gray-600 text-lg hover:underline",children:"add image?"}),(u||i)&&e.jsx("div",{className:"w-full mt-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-center md:gap-8 space-y-4 md:space-y-0",children:[u&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Preview:"}),e.jsx("div",{className:"w-full max-w-[300px] aspect-square rounded-lg shadow-md overflow-hidden",children:e.jsx("img",{src:u,alt:"Preview",className:"w-full h-full object-cover"})})]}),i&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h3",{className:"font-semibold mb-2 text-center w-full",children:"Metadata:"}),e.jsx("ul",{className:"space-y-1 text-sm md:text-base",children:Object.entries(i).map(([t,s])=>e.jsxs("li",{className:"text-white",children:[e.jsxs("span",{className:"font-medium capitalize",children:[t,":"]})," ",e.jsx("span",{className:"break-all",children:s})]},t))})]})]})}),a&&e.jsxs("div",{className:"flex gap-4 mt-5",children:[e.jsx(j,{onClick:p,text_false:"Cancel"}),e.jsx(j,{onClick:g,text_false:"Upload Image"})]})]})},M=()=>{const[l,d]=n.useState([]),[a,c]=n.useState(null),[u,o]=n.useState(null),[i,m]=n.useState(!1);n.useEffect(()=>{(async()=>{try{const r=await w.get("/api/imagelist");d(r.data)}catch(r){console.error("Error fetching images:",r)}})()},[]),n.useEffect(()=>{l.length>0&&c(l[0])},[l]);const f=s=>{c(s)},h=s=>{m(!1),o(s)},p=()=>{o(null)},t={gridTemplateColumns:`repeat(${Math.floor(Math.sqrt(l.length))}, minmax(0, 1fr))`};return e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center w-full lg:flex-row lg:items-stretch lg:gap-4",children:[e.jsx("div",{className:"w-full lg:w-[34.5%] mb-4 lg:mb-0",children:e.jsx("div",{className:"grid w-full aspect-square",style:t,children:l.map((s,r)=>e.jsx(N,{path:s.path,onClick:()=>f(s),onEnter:()=>h(s.path),onLeave:p},r))})}),e.jsx("div",{className:"relative w-full lg:w-[60%] aspect-[3/2] transition-opacity duration-200",onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),children:a&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:u||a.path,className:`w-full h-full object-cover ${i?"opacity-50":""}`,alt:"Main display"}),i&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"bg-black/30 p-4 rounded",children:a.info.includes("{")?Object.entries(JSON.parse(a.info)).map(([s,r])=>e.jsxs("p",{className:"text-white",children:[s,": ",r]},s)):e.jsx("p",{className:"text-white",children:a.info})})})]})})]}),e.jsx(b,{images:l,setImages:d})]})};export{M as default};
